<div class="column padding-reset" style="margin-top:50px;">
  <div class="ui small message page grid center aligned">
    <h1 class="ui huge header">Administration des Articles</h1>
    <p><div class="ui blue button" ng-click="openCreationModal()">Créer un nouvel article</div></p>
  </div>

  <div class="ui form">
    <div class="field">
      <div class="ui icon input">
        <input type="text" placeholder="Filtrer sur n'importe quelle colonne du tableau ..." ng-model="searchText">
        <i class="search icon"></i>
      </div>
    </div>
  </div>
  
  <pagination class="pagination-wrapper center aligned" entity="entity" pages="nbPages" datas="allPosts" nb-pages="nbPages" current-page="currentPage"></pagination>

  <div class="sixteen wide column white">

    <table class="ui sortable table loading">
      <thead>
        <tr>
          <th ng-click="changeSorting($event,'id')" >Id</th>
          <th ng-click="changeSorting($event,'title')">Titre</th>
          <th ng-click="changeSorting($event,'created_at')"  class="descending">Crée le</th>
          <th ng-click="changeSorting($event,'updated_at')">Edité le</th>
          <th ng-click="changeSorting($event,'user_id')">Auteur</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <!-- Start Loop -->
        <tr ng-repeat="post in posts | orderBy:sort.column:sort.descending | filter:searchText:strict track by post.id">
          <td>{{ post.id }}</td>
          <td>{{ post.title | limitTo : 75}} ...</td>
          <td>{{post.created_at | dateToISO | date:'dd/MM/yyyy'}}</td>
          <td>{{post.updated_at | dateToISO | date:'dd/MM/yyyy'}}</td>
          <td>{{post.user_id}}</td>
          <td>
            <div class="ui icon button positive" ng-click="openEditionModal(post)" data-content="Editer l'article">
              <i class="edit icon"></i>
            </div>
            <div class="ui icon button negative" ng-click="openDeletePostModal(post)">
              <i class="trash icon"></i>
            </div>
            <div class="ui icon button primary" ng-click="go('#/post/'+post.id)">
              <i class="eye icon"></i>
            </div>
            <div class="ui icon button basic">
              <i class="icon" ng-class="publicationState(post)"></i>
            </div>
          </td>
        </tr>
        <!-- End Loop -->
      </tbody>
    </table>
  </div>
  <pagination class="pagination-wrapper center aligned" entity="entity" pages="nbPages" datas="allPosts" nb-pages="nbPages" current-page="currentPage"></pagination>

</div>

<!-- CREATION/EDITION MODAL -->
<div class="ui fullscreen modal long" id="postModal" nv-file-drop uploader="uploader">
  <i class="close icon"></i>
  <div class="header">
    {{ modal.mode == "create" ? "Creation d'un nouvel Article" : "Edition de l'article" }}
  </div>
  <div class="content">
    <form name="postForm" class="ui form" ng-submit="postForm()" novalidate>
      <input type="hidden" ng-model="currentPost.id">

      <div class="field" ng-class="{ error: postForm.$submitted && postForm.title.$error.required }">
        <label>Titre</label>
        <div class="ui corner labeled input">
          <input type="text" name="title" placeholder="Titre de l'article" ng-model="currentPost.title" required>
          <div class="ui corner label">
            <i class="asterisk icon"></i>
          </div>

          <div ng-show="postForm.$submitted">
            <div ng-show="postForm.title.$error.required">
              Veuillez entrer un titre pour l' article
            </div>
          </div>
        </div> <!-- /ui corner labeled input -->
      </div> <!-- Field title -->

      <!-- Image manager -->
      <div id="image-uploader" class="field">
        <label>Image de couverture</label>
        <div class="ui right aligned grid">
          <!-- UPLOAD IMAGE ZONE -->
          <div img-uploader class="center aligned two columns row"></div>
        </div>  
      </div><!-- .field image -->


      <div class="field">
        <label>Introduction</label>
        <div text-angular ng-model="currentPost.excerpt"></div>

        <!-- <div ng-show="postForm.$submitted">
          <div ng-show="postForm.excerpt.$error.required">
            Veuillez entrer un extrait pour l' article
          </div>
        </div> -->
      </div>


      <div class="field">
        <label>Contenu</label>
        <div text-angular ng-model="currentPost.content"></div>

       <!--  <div ng-show="postForm.$submitted">
          Veuillez entrer un contenu pour l' article
        </div> -->
      </div>


     <!--  <div class="field">
        <div id="status" ng-click="changeStatus()" class="ui toggle checkbox"> 
          <input type="checkbox" 
                 ng-model="currentPost.status"
                 value="{{currentPost.status}}">
          <label>Publier {{ currentPost.status }}</label>
        </div>
      </div> -->

      <div class="ui buttons">
        <input type="submit" value="{{ modal.mode == 'create' ? 'Creer' : 'Enregistrer les modifications' }}" class="ui submit positive button"/>
        <div class="or"></div>
        <div class="ui button negative reset">Annuler</div>
      </div>
    </form>
  </div>
</div>

<!-- DELETE POST MODAL -->
<div id="deletePostModal" class="ui small modal">
  <i class="close icon"></i>
  <div class="header">
    Supprimer
  </div>
  <div class="content">
    <p>Voulez vous supprimer définitivement le Post suivant ?</p>
    <b>Id :</b>  <em>{{ currentPost.id}}</em>&nbsp;&nbsp;&nbsp;&nbsp;<b>Status :</b><em>{{ currentPost.status }}</em>
    <p><b>Titre :</b><em ng-bind="currentPost.title"></em></p>
  </div>
  <div class="actions">
    <div class="ui negative button">
      Non
    </div>
    <div class="ui positive right labeled icon button" ng-click="deletePost()">
      Oui
      <i class="checkmark icon"></i>
    </div>
  </div>
</div>

